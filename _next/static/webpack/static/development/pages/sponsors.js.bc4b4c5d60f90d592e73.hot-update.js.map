{"version":3,"file":"static/webpack/static\\development\\pages\\sponsors.js.bc4b4c5d60f90d592e73.hot-update.js","sources":["webpack:///./pages/sponsors/bloc/donation_section_bloc.ts"],"sourcesContent":["import { Bloc } from '@felangel/bloc';\r\nimport HelperApiRepository from '~/src/repository/helper_repository';\r\n\r\nexport abstract class DonationSectionEvent {\r\n}\r\n\r\nexport enum DonationType {\r\n  Top,\r\n  Latest,\r\n}\r\n\r\nexport class PageStartEvent extends DonationSectionEvent {\r\n  type: DonationType\r\n  constructor(\r\n    type: DonationType\r\n  ) {\r\n    super();\r\n    this.type = type;\r\n  }\r\n}\r\n\r\nexport class NextPageEvent extends DonationSectionEvent {\r\n}\r\n\r\nexport class PreviousPageEvent extends DonationSectionEvent {\r\n}\r\n\r\nexport class DonationSectionState<T> {\r\n  constructor(\r\n    readonly isNextValid: boolean,\r\n    readonly isPrevValid: boolean,\r\n    readonly isLoading: boolean,\r\n    readonly page: number,\r\n    readonly datas: Array<T>,\r\n  ) {\r\n  }\r\n\r\n  static empty() {\r\n    return new DonationSectionState(\r\n      true,\r\n      false,\r\n      false,\r\n      0,\r\n      []\r\n    )\r\n  }\r\n\r\n  copyWith({\r\n    isNextValid,\r\n    isPrevValid,\r\n    isLoading,\r\n    page,\r\n    datas,\r\n  }: {\r\n    isNextValid?: boolean,\r\n    isPrevValid?: boolean,\r\n    isLoading?: boolean,\r\n    page?: number,\r\n    datas?: Array<T>,\r\n  }) {\r\n    return new DonationSectionState(\r\n      isNextValid != null ? isNextValid : this.isNextValid,\r\n      isPrevValid != null ? isPrevValid : this.isPrevValid,\r\n      isLoading != null ? isLoading : this.isLoading,\r\n      page != null ? page : this.page,\r\n      datas != null ? datas : this.datas,\r\n    )\r\n  }\r\n}\r\n\r\nexport class DonationSectionBloc<T> extends Bloc<DonationSectionEvent, DonationSectionState<T>> {\r\n  initialState(): DonationSectionState<T> {\r\n    return DonationSectionState.empty();\r\n  }\r\n\r\n  async *mapEventToState(event: DonationSectionEvent): AsyncIterableIterator<DonationSectionState> {\r\n    if(event instanceof PageStartEvent) {\r\n      yield* this._mapPageStartEventToState(event);\r\n    } else if(event instanceof NextPageEvent) {\r\n      yield* this._mapNextPageEventToState(event);\r\n    } else if(event instanceof PreviousPageEvent) {\r\n      yield* this._mapPreviousPageEventToState(event);\r\n    }\r\n  }\r\n\r\n  async *_mapPageStartEventToState(event: PageStartEvent) {\r\n    const currentState = this.currentState;\r\n    yield currentState.copyWith({\r\n      isLoading: true\r\n    });\r\n    // let data;\r\n    if(event.type == DonationType.Top) {\r\n      let datas = await HelperApiRepository.getTop(0);\r\n      //data[0]\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: false,\r\n        isNextValid: datas.length == 10,\r\n        page: 0,\r\n        datas: datas\r\n      });\r\n    }\r\n    if(event.type == DonationType.Latest) {\r\n      let datas = await HelperApiRepository.getLatest(0);\r\n      //data[0]\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: false,\r\n        isNextValid: datas.length == 10,\r\n        page: 0,\r\n        datas: datas\r\n      });\r\n    }\r\n  }\r\n  async *_mapNextPageEventToState(event: NextPageEvent) {\r\n    const currentState = this.currentState;\r\n    yield currentState.copyWith({\r\n      isLoading: true\r\n    });\r\n    // let data;\r\n    if(event.type == DonationType.Top) {\r\n      let datas = await HelperApiRepository.getTop(currentState.page + 1);\r\n      const finalPage = datas.length == 0 ? currentState.page : currentState.page + 1\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: finalPage !== 0,\r\n        isNextValid: datas.length == 10,\r\n        page: finalPage,\r\n        datas: datas\r\n      });\r\n    }\r\n    if(event.type == DonationType.Latest) {\r\n      let datas = await HelperApiRepository.getLatest(currentState.page + 1);\r\n      const finalPage = datas.length == 0 ? currentState.page : currentState.page + 1\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: finalPage !== 0,\r\n        isNextValid: datas.length == 10,\r\n        page: finalPage,\r\n        datas: datas\r\n      });\r\n    }\r\n  }\r\n  async *_mapPreviousPageEventToState(event: PreviousPageEvent) {\r\n    const currentState = this.currentState;\r\n    yield currentState.copyWith({\r\n      isLoading: true\r\n    });\r\n    // let data;\r\n    if(event.type == DonationType.Top) {\r\n      let datas = await HelperApiRepository.getTop(Math.max(0, currentState.page - 1));\r\n      //data[0]\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: page !== 0,\r\n        isNextValid: true,\r\n        page: Math.max(0, currentState.page - 1),\r\n        datas: datas\r\n      });\r\n    }\r\n    if(event.type == DonationType.Latest) {\r\n      let datas = await HelperApiRepository.getLatest(Math.max(0, currentState.page - 1));\r\n      //data[0]\r\n      yield currentState.copyWith({\r\n        isLoading: false,\r\n        isPrevValid: page !== 0,\r\n        isNextValid: true,\r\n        page: Math.max(0, currentState.page - 1),\r\n        datas: datas\r\n      });\r\n    }\r\n  }\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AAAA;AAAA;AAGA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAIA;AAAA;AACA;AACA;AAEA;AACA;AADA;AACA;AAAA;AACA;AAFA;AACA;AACA;AAFA;AAGA;AACA;AARA;AAAA;AAUA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAGA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAGA;AACA;AAMA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AATA;AAAA;AAAA;AAgCA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AAxCA;AAAA;AAAA;AAWA;AAOA;AAlBA;AACA;AADA;AAAA;AA2CA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAEA;AACA;AAHA;AAAA;AAAA;AAKA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AALA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAbA;AAAA;AAAA;AAeA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AADA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAOA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAkBA;AAlBA;AAoBA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4BA;AA3CA;AAAA;AAAA;AA4CA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AADA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAOA;AACA;AARA;AASA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAkBA;AACA;AAnBA;AAoBA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4BA;AAxEA;AAAA;AAAA;AAyEA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AADA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAOA;AAPA;AASA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAkBA;AAlBA;AAoBA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4BA;AArGA;AACA;AADA;AAAA;;;;A","sourceRoot":""}